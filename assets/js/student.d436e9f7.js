(window.webpackJsonp=window.webpackJsonp||[]).push([["student"],{"0f06":function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return s}));a("99af");var n=a("2b0e");function o(e){var t="".concat("http://channingkuo.synology.me:9001","/class/list");return n.a.httpfire.post(t,e)}function r(e){var t="".concat("http://channingkuo.synology.me:9001","/class/delete/").concat(e);return n.a.httpfire.post(t)}function s(e){var t="".concat("http://channingkuo.synology.me:9001","/class/save");return n.a.httpfire.post(t,e)}},1:function(e,t){},2:function(e,t){},3:function(e,t){},"5b94":function(e,t,a){"use strict";a.r(t);var n=a("5530"),o=a("1da1"),r=(a("d81d"),a("b0c0"),a("96cf"),a("2f62")),s=a("2909"),i=(a("99af"),a("8237")),c=a.n(i),l=a("1146"),u=a.n(l),d=a("e4e2"),p=a("cd77"),f=[{title:"#",dataIndex:"index",scopedSlots:{customRender:"index"},width:60,align:"center"},{title:"班级",dataIndex:"className",scopedSlots:{customRender:"className"},align:"center"},{title:"姓名",dataIndex:"name",scopedSlots:{customRender:"name"},align:"center"},{title:"性别",dataIndex:"gender",scopedSlots:{customRender:"gender"},align:"center"}],m={name:"Student-Excel-Import",props:{title:{type:String,default:"导入"},type:{type:String,default:"primary"},icon:{type:String,default:""}},data:function(){return{visible:!1,confirmLoading:!1,file:null,loading:!1,columns:f,studentList:[],poiTypeOptions:[],poiStatusOptions:[],project:{id:null,name:""},subitem:{id:null,name:""},projectSet:[],subitemSet:[]}},mounted:function(){},methods:{md5:c.a,onSelectFile:function(){return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},onFileChange:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=[],r=e.target.files[0],null===t.file||t.file===r){a.next=6;break}t.$modal.confirm({title:"是否覆盖之前导入的数据",zIndex:1e5,okText:"确认",centered:!0,onOk:function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.file=r,t.loading=!0,e.next=4,Object(p.b)(r);case 4:n=e.sent,t.loading=!1,document.getElementById("excelImport").value="",t.genTableData(n);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),a.next=15;break;case 6:return t.file=r,t.loading=!0,a.next=10,Object(p.b)(r);case 10:n=a.sent,t.loading=!1,document.getElementById("excelImport").value="",t.genTableData(n);case 15:case"end":return a.stop()}}),a)})))()},genTableData:function(e){for(var t=0;t<e.length;t++){for(var a=e[t],n={},o=0;o<d.length;o++){var r=d[o];n[r.value]=a[r.label]}this.studentList.push(n)}},onDownloadTemplate:function(){return Object(o.a)(regeneratorRuntime.mark((function e(){var t,a,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],(a=[])[0]=[],n=0;n<d.length;n++)o=d[n],a[0]=[].concat(Object(s.a)(a[0]),[o.label]);a[1]=["4（7）班","Kuo","男","本行数据为示例数据，参考后请删除!"],t.push({name:"sheet1",sheet:u.a.utils.aoa_to_sheet(a)}),Object(p.a)(Object(p.c)(t),"学生导入模版.xlsx");case 7:case"end":return e.stop()}}),e)})))()},onHandleOk:function(){this.studentList.length<=0?this.$message.info("至少导入一条数据！"):(this.visible=!1,this.$emit("upload",this.studentList),this.onCloseModal())},onCloseModal:function(){this.studentList=[],this.subitem={id:null,name:""},this.file=null}},computed:{}},g=(a("e4e7"),a("2877")),h=Object(g.a)(m,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-button",{attrs:{type:e.type,icon:e.icon},on:{click:function(t){e.visible=!e.visible}}},[e._v(" "+e._s(e.title)+" ")]),a("a-modal",{attrs:{closable:!1,"mask-closable":!1,title:"学生信息: Excel导入",width:"80%","mask-style":{zIndex:1e3},"z-index":1001,confirmLoading:e.confirmLoading,"destroy-on-close":!0},on:{ok:e.onHandleOk,cancel:e.onCloseModal},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("a-page-header",{staticClass:"k-ant-page-header",style:{padding:0,border:"none"}},[a("template",{slot:"extra"},[a("a-row",{attrs:{type:"flex",justify:"start"}},[a("a-button",{staticClass:"input-button",attrs:{type:"primary",title:"选择导入文件"},on:{click:e.onSelectFile}},[a("input",{attrs:{id:"excelImport",type:"file",accept:".xlsx,.xls"},on:{change:e.onFileChange}}),e._v("选择导入文件 ")]),a("a-button",{staticStyle:{"margin-left":"20px"},on:{click:e.onDownloadTemplate}},[e._v(" 下载模版 ")])],1)],1),a("a-divider",{style:{margin:0,marginTop:"15px"},attrs:{dashed:!0}}),a("a-row",{attrs:{type:"flex"}},[a("a-col",{attrs:{span:24}},[a("a-table",{attrs:{"row-key":function(t){return e.md5(JSON.stringify(t))},"data-source":e.studentList,columns:e.columns,pagination:!1,loading:e.loading},scopedSlots:e._u([{key:"index",fn:function(t,a,n){return[e._v(" "+e._s(n+1)+" ")]}},{key:"className",fn:function(t,n){return[a("a-tooltip",{attrs:{placement:"top",title:t}},[a("a-input",{attrs:{placeholder:"班级"},model:{value:n.className,callback:function(t){e.$set(n,"className",t)},expression:"record.className"}})],1)]}},{key:"name",fn:function(t,n){return[a("a-tooltip",{attrs:{placement:"top",title:t}},[a("a-input",{attrs:{placeholder:"姓名"},model:{value:n.name,callback:function(t){e.$set(n,"name",t)},expression:"record.name"}})],1)]}},{key:"gender",fn:function(t,n){return[a("a-tooltip",{attrs:{placement:"top",title:t}},[a("a-select",{staticStyle:{width:"100%"},on:{change:function(e,t){n.gender=e}},model:{value:n.gender,callback:function(t){e.$set(n,"gender",t)},expression:"record.gender"}},[a("a-select-option",{attrs:{value:"男"}},[e._v(" 男 ")]),a("a-select-option",{attrs:{value:"女"}},[e._v(" 女 ")])],1)],1)]}}])})],1)],1)],2)],1)],1)}),[],!1,null,"a8a8cc38",null).exports,v=a("2b0e");function b(e){var t="".concat("http://channingkuo.synology.me:9001","/student/save");return v.a.httpfire.post(t,e)}var x=a("0f06"),w={name:"Student",components:{StudentExcelImport:h},data:function(){return{studentName:"",className:"",columns:[{title:"#",dataIndex:"index",scopedSlots:{customRender:"index"},width:60,align:"center"},{title:"班级",dataIndex:"cea_class_name",align:"center"},{title:"姓名",dataIndex:"cea_student_name",scopedSlots:{customRender:"cea_student_name"},align:"center"},{title:"性别",dataIndex:"cea_student_gender",scopedSlots:{customRender:"cea_student_gender"},align:"center"},{title:"操作",align:"center",dataIndex:"operator",scopedSlots:{customRender:"operator"},width:200}],studentList:[],loading:!1,form:this.$form.createForm(this),visible:!1,classList:[],submitLoading:!1}},mounted:function(){var e=this;this.$nextTick((function(){e.loadList(),e.loadClassList()}))},methods:{loadList:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,a={className:e.className,studentName:e.studentName},t.next=4,o=a,r=void 0,r="".concat("http://channingkuo.synology.me:9001","/student/list"),v.a.httpfire.post(r,o);case 4:n=t.sent,e.loading=!1,e.studentList=n;case 7:case"end":return t.stop()}var o,r}),t)})))()},loadClassList:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(x.b)({name:""});case 2:a=t.sent,e.classList=a;case 4:case"end":return t.stop()}}),t)})))()},handleChange:function(){this.loadClassList()},onSearch:function(){this.loadList()},onDeleteRow:function(e,t){var a,n,o=this;(a=e.cea_student_id,n="".concat("http://channingkuo.synology.me:9001","/student/delete/").concat(a),v.a.httpfire.post(n)).then((function(e){o.loadList()}))},onUpload:function(e){var t=this;this.$message.info("正在导入..."),function(e){var t="".concat("http://channingkuo.synology.me:9001","/student/upload");return v.a.httpfire.post(t,e)}(e).then((function(e){e.length>0?t.$modal.confirm({title:"上传失败记录",content:function(t){return t("div",e.map((function(e){return t("p",{style:{color:"red"},domProps:{innerHTML:e.className+"，"+e.name+"，"+e.gender}})})))},icon:"exclamation-circle",centered:!0,onOk:function(){console.log(e)}}):t.$message.success("导入成功！"),t.loadList()}))},onAdd:function(){this.visible=!0},onClose:function(){this.visible=!1},onAddStudent:function(){var e=this;this.submitLoading=!0,this.form.validateFields((function(t,a){t?e.submitLoading=!1:(e.submitLoading=!1,b(a).then((function(t){e.$message.success("添加成功！"),e.visible=!1,e.loadList()})).catch((function(t){e.$message.error(t)})))}))},onEditRow:function(e,t){this.$set(e,"editing",!0)},onCancelEditRow:function(e,t){this.$set(e,"editing",!1)},onSaveEditRow:function(e,t){var a=this;console.log(e),b({ceaStudentId:e.cea_student_id,ceaClassId:e.cea_class_id,ceaStudentName:e.cea_student_name,ceaStudentGender:e.cea_student_gender,ceaStudentStatus:e.cea_student_status}).then((function(e){a.$message.success("修改成功！"),a.loadList()}))}},computed:Object(n.a)({},Object(r.b)(["userInfo"]))},y=Object(g.a)(w,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-page-header",{staticClass:"k-ant-page-header"},[a("template",{slot:"extra"},[a("a-row",{attrs:{type:"flex",justify:"space-between",align:"bottom",gutter:{xs:8,sm:16,md:24}}},[a("a-col",{attrs:{span:17}},[a("a-row",{attrs:{type:"flex",justify:"start",align:"middle"}},[a("span",{staticClass:"search-field-control-header"},[e._v("班级：")]),a("a-input",{style:{marginRight:"20px",width:"160px"},attrs:{allowClear:"",placeholder:"输入班级"},on:{pressEnter:e.onSearch},model:{value:e.className,callback:function(t){e.className=t},expression:"className"}}),a("span",{staticClass:"search-field-control-header ml-5"},[e._v("学生姓名：")]),a("a-input",{style:{marginRight:"20px",width:"160px"},attrs:{allowClear:"",placeholder:"输入学生姓名"},on:{pressEnter:e.onSearch},model:{value:e.studentName,callback:function(t){e.studentName=t},expression:"studentName"}}),a("a-button",{attrs:{type:"primary"},on:{click:e.onSearch}},[e._v(" 筛选 ")])],1)],1),a("a-col",{staticClass:"flex justify-end"},[a("a-tooltip",{attrs:{placement:"top",title:"批量导入学生"}},[a("student-excel-import",{staticStyle:{"margin-right":"10px","margin-left":"10px"},attrs:{type:"default"},on:{upload:e.onUpload}})],1),a("a-tooltip",{staticClass:"ml-5",attrs:{placement:"top",title:"添加单个学生"}},[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.onAdd()}}},[e._v(" 添加 ")])],1)],1)],1)],1),a("a-row",{attrs:{type:"flex"}},[a("a-col",{attrs:{span:24}},[a("a-table",{staticClass:"k-table",attrs:{columns:e.columns,"row-key":function(e){return e.cea_student_id},"data-source":e.studentList,loading:e.loading,pagination:!1,rowClassName:function(e,t){return t%2==0?"single":"double"}},scopedSlots:e._u([{key:"index",fn:function(t,a,n){return[e._v(" "+e._s(n+1)+" ")]}},{key:"cea_student_name",fn:function(t,n){return[n.editing?[a("a-input",{style:{width:"160px"},attrs:{allowClear:"",placeholder:"输入学生姓名"},model:{value:n.cea_student_name,callback:function(t){e.$set(n,"cea_student_name",t)},expression:"record.cea_student_name"}})]:[e._v(" "+e._s(t)+" ")]]}},{key:"cea_student_gender",fn:function(t,n){return[n.editing?[a("a-select",{attrs:{placeholder:"请选择学生性别"},model:{value:n.cea_student_gender,callback:function(t){e.$set(n,"cea_student_gender",t)},expression:"record.cea_student_gender"}},[a("a-select-option",{attrs:{value:0}},[e._v(" 男 ")]),a("a-select-option",{attrs:{value:1}},[e._v(" 女 ")])],1)]:[t?e._e():a("a-tag",{attrs:{color:"volcano"}},[e._v(" 男 ")]),t?a("a-tag",{attrs:{color:"pink"}},[e._v(" 女 ")]):e._e()]]}},{key:"operator",fn:function(t,n,o){return[a("div",{staticClass:"flex justify-around justify-items-center"},[n.editing?a("a",{on:{click:function(t){return e.onCancelEditRow(n,o)}}},[e._v("取消")]):a("a",{on:{click:function(t){return e.onEditRow(n,o)}}},[e._v("编辑")]),n.editing?a("a",{on:{click:function(t){return e.onSaveEditRow(n,o)}}},[e._v("保存")]):e._e(),a("a-popconfirm",{attrs:{title:"是否确认删除该行?一旦删除，数据无法恢复！","ok-text":"确认","cancel-text":"取消",placement:"bottomRight"},on:{confirm:function(){return e.onDeleteRow(n,o)}}},[a("a-icon",{staticStyle:{color:"#ff4242"},attrs:{slot:"icon",type:"exclamation-circle"},slot:"icon"}),a("a",[e._v("删除")])],1)],1)]}}])})],1)],1),a("a-drawer",{staticClass:"huahua-drawer",attrs:{title:"添加学生",width:720,destroyOnClose:"",visible:e.visible},on:{close:e.onClose}},[a("a-form",{attrs:{form:e.form,layout:"vertical","hide-required-mark":""}},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"班级"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["ceaClassId",{rules:[{required:!0,message:"请选择学生班级"}]}],expression:"[\n                'ceaClassId',\n                {\n                  rules: [{ required: true, message: '请选择学生班级' }]\n                }\n              ]"}],attrs:{allowClear:"",placeholder:"请选择学生班级"}},e._l(e.classList,(function(t){return a("a-select-option",{key:t.ceaClassId,attrs:{value:t.ceaClassId}},[e._v(" "+e._s(t.ceaClassName)+" ")])})),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"姓名"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ceaStudentName",{rules:[{required:!0,message:"请输入学生姓名"}]}],expression:"[\n                'ceaStudentName',\n                {\n                  rules: [{ required: true, message: '请输入学生姓名' }]\n                }\n              ]"}],attrs:{allowClear:"",placeholder:"请输入学生姓名"}})],1)],1)],1),a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"性别"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["ceaStudentGender",{rules:[{required:!0,message:"请选择学生性别"}]}],expression:"[\n                'ceaStudentGender',\n                {\n                  rules: [{ required: true, message: '请选择学生性别' }]\n                }\n              ]"}],attrs:{allowClear:"",placeholder:"请选择学生性别"}},[a("a-select-option",{attrs:{value:0}},[e._v(" 男 ")]),a("a-select-option",{attrs:{value:1}},[e._v(" 女 ")])],1)],1)],1)],1)],1),a("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[a("a-button",{style:{marginRight:"8px"},on:{click:e.onClose}},[e._v(" 取消 ")]),a("a-button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.onAddStudent}},[e._v(" 提交 ")])],1)],1)],2)}),[],!1,null,null,null);t.default=y.exports},6359:function(e,t,a){var n=a("f67a");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a("499e").default)("de60db52",n,!0,{sourceMap:!1,shadowMode:!1})},cd77:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return c}));var n=a("53ca"),o=(a("d3b7"),a("ac1f"),a("1276"),a("b0c0"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("fb6a"),a("c19f"),a("3ca3"),a("ddb0"),a("2b3d"),a("1146")),r=a.n(o);function s(e){var t=this;return new Promise((function(a,n){if("xls"!==e.name.split(".")[1]&&"xlsx"!==e.name.split(".")[1])t.$message.error("上传文件格式错误，请上传xls、xlsx文件！");else{var o=new FileReader;o.onload=function(e){var t=function(e){for(var t="",a=0,n=10240;a<e.byteLength/n;++a)t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(a*n,a*n+n)));return t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(a*n)))}(e.target.result),n=r.a.read(btoa(t),{type:"base64"}),o=n.SheetNames[0],s=n.Sheets[o],i=r.a.utils.sheet_to_json(s);a(i)},o.readAsArrayBuffer(e)}}))}function i(e){for(var t=[],a=0;a<e.length;a++)t[a]=e[a].name||"sheet".concat(a+1);for(var n={SheetNames:t,Sheets:{}},o=0;o<e.length;o++)n.Sheets[e[o].name]=e[o].sheet;var s=r.a.write(n,{bookType:"xlsx",bookSST:!1,type:"binary"});return new Blob([function(e){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),n=0;n!==e.length;++n)a[n]=255&e.charCodeAt(n);return t}(s)],{type:"application/octet-stream"})}function c(e,t){"object"===Object(n.a)(e)&&e instanceof Blob&&(e=URL.createObjectURL(e));var a,o=document.createElement("a");o.href=e,o.download=t||"",window.MouseEvent?a=new MouseEvent("click"):(a=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(a)}},d81d:function(e,t,a){"use strict";var n=a("23e7"),o=a("b727").map;n({target:"Array",proto:!0,forced:!a("1dde")("map")},{map:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},e4e2:function(e){e.exports=JSON.parse('[{"label":"班级","value":"className"},{"label":"姓名","value":"name"},{"label":"性别","value":"gender"}]')},e4e7:function(e,t,a){"use strict";a("6359")},f67a:function(e,t,a){(t=a("24fb")(!1)).push([e.i,".k-ant-page-header .ant-page-header-heading-extra[data-v-a8a8cc38]{float:unset}.k-table .ant-table-pagination[data-v-a8a8cc38]{float:left!important}.k-table .ant-table-thead>tr>th[data-v-a8a8cc38]{background-color:#fff!important}.huahua-drawer .ant-select-selection__clear[data-v-a8a8cc38]{margin-top:-8px}.single[data-v-a8a8cc38]{background-color:#fbfafa}.clock-full-screen .ant-modal-centered[data-v-a8a8cc38]{overflow-y:hidden}.windows[data-v-a8a8cc38] ::-webkit-scrollbar{width:6px;height:6px}.windows[data-v-a8a8cc38] ::-webkit-scrollbar-track{width:10px;background:rgba(145,146,146,.1);border-radius:2em}.windows[data-v-a8a8cc38] ::-webkit-scrollbar-thumb{background-color:rgba(145,146,146,.3);background-clip:padding-box;min-height:28px;border-radius:2em}.windows[data-v-a8a8cc38] ::-webkit-scrollbar-corner{border-radius:2em}.windows[data-v-a8a8cc38] ::-webkit-scrollbar-thumb:hover{background-color:#919292}.input-button input[data-v-a8a8cc38]{position:absolute;font-size:100px;right:0;top:0;opacity:0;filter:alpha(opacity=0);cursor:pointer}",""]),e.exports=t}}]);