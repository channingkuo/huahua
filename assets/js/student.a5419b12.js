(window.webpackJsonp=window.webpackJsonp||[]).push([["student"],{"0f06":function(t,e,a){"use strict";a.d(e,"b",(function(){return r})),a.d(e,"a",(function(){return o})),a.d(e,"c",(function(){return s}));a("99af");var n=a("2b0e");function r(t){var e="".concat("http://localhost:1101","/class/list");return n.a.httpfire.post(e,t)}function o(t){var e="".concat("http://localhost:1101","/class/delete/").concat(t);return n.a.httpfire.post(e)}function s(t){var e="".concat("http://localhost:1101","/class/save");return n.a.httpfire.post(e,t)}},1:function(t,e){},2:function(t,e){},3:function(t,e){},"5b94":function(t,e,a){"use strict";a.r(e);var n=a("5530"),r=a("1da1"),o=(a("d81d"),a("b0c0"),a("96cf"),a("2f62")),s=a("2909"),i=(a("99af"),a("8237")),c=a.n(i),l=a("1146"),u=a.n(l),d=a("e4e2"),p=a("cd77"),f=[{title:"#",dataIndex:"index",scopedSlots:{customRender:"index"},width:60,align:"center"},{title:"班级",dataIndex:"className",scopedSlots:{customRender:"className"},align:"center"},{title:"姓名",dataIndex:"name",scopedSlots:{customRender:"name"},align:"center"},{title:"性别",dataIndex:"gender",scopedSlots:{customRender:"gender"},align:"center"}],m={name:"Student-Excel-Import",props:{title:{type:String,default:"导入"},type:{type:String,default:"primary"},icon:{type:String,default:""}},data:function(){return{visible:!1,confirmLoading:!1,file:null,loading:!1,columns:f,studentList:[],poiTypeOptions:[],poiStatusOptions:[],project:{id:null,name:""},subitem:{id:null,name:""},projectSet:[],subitemSet:[]}},mounted:function(){},methods:{md5:c.a,onSelectFile:function(){return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))()},onFileChange:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function a(){var n,o;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=[],o=t.target.files[0],null===e.file||e.file===o){a.next=6;break}e.$modal.confirm({title:"是否覆盖之前导入的数据",zIndex:1e5,okText:"确认",centered:!0,onOk:function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.file=o,e.loading=!0,t.next=4,Object(p.b)(o);case 4:n=t.sent,e.loading=!1,document.getElementById("excelImport").value="",e.genTableData(n);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}),a.next=15;break;case 6:return e.file=o,e.loading=!0,a.next=10,Object(p.b)(o);case 10:n=a.sent,e.loading=!1,document.getElementById("excelImport").value="",e.genTableData(n);case 15:case"end":return a.stop()}}),a)})))()},genTableData:function(t){for(var e=0;e<t.length;e++){for(var a=t[e],n={},r=0;r<d.length;r++){var o=d[r];n[o.value]=a[o.label]}this.studentList.push(n)}},onDownloadTemplate:function(){return Object(r.a)(regeneratorRuntime.mark((function t(){var e,a,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=[],(a=[])[0]=[],n=0;n<d.length;n++)r=d[n],a[0]=[].concat(Object(s.a)(a[0]),[r.label]);a[1]=["4（7）班","Kuo","男","本行数据为示例数据，参考后请删除!"],e.push({name:"sheet1",sheet:u.a.utils.aoa_to_sheet(a)}),Object(p.a)(Object(p.c)(e),"学生导入模版.xlsx");case 7:case"end":return t.stop()}}),t)})))()},onHandleOk:function(){this.studentList.length<=0?this.$message.info("至少导入一条数据！"):(this.visible=!1,this.$emit("upload",this.studentList),this.onCloseModal())},onCloseModal:function(){this.studentList=[],this.subitem={id:null,name:""},this.file=null}},computed:{}},h=(a("e4e7"),a("2877")),g=Object(h.a)(m,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-button",{attrs:{type:t.type,icon:t.icon},on:{click:function(e){t.visible=!t.visible}}},[t._v(" "+t._s(t.title)+" ")]),a("a-modal",{attrs:{closable:!1,"mask-closable":!1,title:"学生信息: Excel导入",width:"80%","mask-style":{zIndex:1e3},"z-index":1001,confirmLoading:t.confirmLoading,"destroy-on-close":!0},on:{ok:t.onHandleOk,cancel:t.onCloseModal},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("a-page-header",{staticClass:"k-ant-page-header",style:{padding:0,border:"none"}},[a("template",{slot:"extra"},[a("a-row",{attrs:{type:"flex",justify:"start"}},[a("a-button",{staticClass:"input-button",attrs:{type:"primary",title:"选择导入文件"},on:{click:t.onSelectFile}},[a("input",{attrs:{id:"excelImport",type:"file",accept:".xlsx,.xls"},on:{change:t.onFileChange}}),t._v("选择导入文件 ")]),a("a-button",{staticStyle:{"margin-left":"20px"},on:{click:t.onDownloadTemplate}},[t._v(" 下载模版 ")])],1)],1),a("a-divider",{style:{margin:0,marginTop:"15px"},attrs:{dashed:!0}}),a("a-row",{attrs:{type:"flex"}},[a("a-col",{attrs:{span:24}},[a("a-table",{attrs:{"row-key":function(e){return t.md5(JSON.stringify(e))},"data-source":t.studentList,columns:t.columns,pagination:!1,loading:t.loading},scopedSlots:t._u([{key:"index",fn:function(e,a,n){return[t._v(" "+t._s(n+1)+" ")]}},{key:"className",fn:function(e,n){return[a("a-tooltip",{attrs:{placement:"top",title:e}},[a("a-input",{attrs:{placeholder:"班级"},model:{value:n.className,callback:function(e){t.$set(n,"className",e)},expression:"record.className"}})],1)]}},{key:"name",fn:function(e,n){return[a("a-tooltip",{attrs:{placement:"top",title:e}},[a("a-input",{attrs:{placeholder:"姓名"},model:{value:n.name,callback:function(e){t.$set(n,"name",e)},expression:"record.name"}})],1)]}},{key:"gender",fn:function(e,n){return[a("a-tooltip",{attrs:{placement:"top",title:e}},[a("a-select",{staticStyle:{width:"100%"},on:{change:function(t,e){n.gender=t}},model:{value:n.gender,callback:function(e){t.$set(n,"gender",e)},expression:"record.gender"}},[a("a-select-option",{attrs:{value:"男"}},[t._v(" 男 ")]),a("a-select-option",{attrs:{value:"女"}},[t._v(" 女 ")])],1)],1)]}}])})],1)],1)],2)],1)],1)}),[],!1,null,"a8a8cc38",null).exports,b=a("2b0e");var v=a("0f06"),x={name:"Student",components:{StudentExcelImport:g},data:function(){return{studentName:"",className:"",columns:[{title:"#",dataIndex:"index",scopedSlots:{customRender:"index"},width:60,align:"center"},{title:"班级",dataIndex:"cea_class_name",align:"center"},{title:"姓名",dataIndex:"cea_student_name",align:"center"},{title:"性别",dataIndex:"cea_student_gender",scopedSlots:{customRender:"cea_student_gender"},align:"center"},{title:"操作",align:"center",dataIndex:"operator",scopedSlots:{customRender:"operator"},width:120}],studentList:[],loading:!1,form:this.$form.createForm(this),visible:!1,classList:[],submitLoading:!1}},mounted:function(){var t=this;this.$nextTick((function(){t.loadList(),t.loadClassList()}))},methods:{loadList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,a={className:t.className,studentName:t.studentName},e.next=4,r=a,o=void 0,o="".concat("http://localhost:1101","/student/list"),b.a.httpfire.post(o,r);case 4:n=e.sent,t.loading=!1,t.studentList=n;case 7:case"end":return e.stop()}var r,o}),e)})))()},loadClassList:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.b)({name:""});case 2:a=e.sent,t.classList=a;case 4:case"end":return e.stop()}}),e)})))()},handleChange:function(){this.loadClassList()},onSearch:function(){this.loadList()},onDeleteRow:function(t,e){var a,n,r=this;(a=t.cea_student_id,n="".concat("http://localhost:1101","/student/delete/").concat(a),b.a.httpfire.post(n)).then((function(t){r.loadList()}))},onUpload:function(t){var e=this;this.$message.info("正在导入..."),function(t){var e="".concat("http://localhost:1101","/student/upload");return b.a.httpfire.post(e,t)}(t).then((function(t){t.length>0?e.$modal.confirm({title:"上传失败记录",content:function(e){return e("div",t.map((function(t){return e("p",{style:{color:"red"},domProps:{innerHTML:t.className+"，"+t.name+"，"+t.gender}})})))},icon:"exclamation-circle",centered:!0,onOk:function(){console.log(t)}}):e.$message.success("导入成功！"),e.loadList()}))},onAdd:function(){this.visible=!0},onClose:function(){this.visible=!1},onAddStudent:function(){var t=this;this.submitLoading=!0,this.form.validateFields((function(e,a){var n,r;e?t.submitLoading=!1:(t.submitLoading=!1,(n=a,r="".concat("http://localhost:1101","/student/save"),b.a.httpfire.post(r,n)).then((function(e){t.$message.success("添加成功！"),t.visible=!1,t.loadList()})).catch((function(e){t.$message.error(e)})))}))}},computed:Object(n.a)({},Object(o.b)(["userInfo"]))},w=Object(h.a)(x,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-page-header",{staticClass:"k-ant-page-header"},[a("template",{slot:"extra"},[a("a-row",{attrs:{type:"flex",justify:"space-between",align:"bottom",gutter:{xs:8,sm:16,md:24}}},[a("a-col",{attrs:{span:17}},[a("a-row",{attrs:{type:"flex",justify:"start",align:"middle"}},[a("span",{staticClass:"search-field-control-header"},[t._v("班级：")]),a("a-input",{style:{marginRight:"20px",width:"160px"},attrs:{allowClear:"",placeholder:"输入班级"},on:{pressEnter:t.onSearch},model:{value:t.className,callback:function(e){t.className=e},expression:"className"}}),a("span",{staticClass:"search-field-control-header ml-5"},[t._v("学生姓名：")]),a("a-input",{style:{marginRight:"20px",width:"160px"},attrs:{allowClear:"",placeholder:"输入学生姓名"},on:{pressEnter:t.onSearch},model:{value:t.studentName,callback:function(e){t.studentName=e},expression:"studentName"}}),a("a-button",{attrs:{type:"primary"},on:{click:t.onSearch}},[t._v(" 筛选 ")])],1)],1),a("a-col",{staticClass:"flex justify-end"},[a("a-tooltip",{attrs:{placement:"top",title:"批量导入学生"}},[a("student-excel-import",{staticStyle:{"margin-right":"10px","margin-left":"10px"},attrs:{type:"default"},on:{upload:t.onUpload}})],1),a("a-tooltip",{staticClass:"ml-5",attrs:{placement:"top",title:"添加单个学生"}},[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.onAdd()}}},[t._v(" 添加 ")])],1)],1)],1)],1),a("a-row",{attrs:{type:"flex"}},[a("a-col",{attrs:{span:24}},[a("a-table",{staticClass:"k-table",attrs:{columns:t.columns,"row-key":function(t){return t.cea_student_id},"data-source":t.studentList,loading:t.loading,pagination:!1,rowClassName:function(t,e){return e%2==0?"single":"double"}},scopedSlots:t._u([{key:"index",fn:function(e,a,n){return[t._v(" "+t._s(n+1)+" ")]}},{key:"cea_student_gender",fn:function(e){return[e?t._e():a("a-tag",{attrs:{color:"volcano"}},[t._v(" 男 ")]),e?a("a-tag",{attrs:{color:"pink"}},[t._v(" 女 ")]):t._e()]}},{key:"operator",fn:function(e,n,r){return[a("div",{staticClass:"flex justify-around justify-items-center"},[a("a-popconfirm",{attrs:{title:"是否确认删除该行?一旦删除，数据无法恢复！","ok-text":"确认","cancel-text":"取消",placement:"bottomRight"},on:{confirm:function(){return t.onDeleteRow(n,r)}}},[a("a-icon",{staticStyle:{color:"#ff4242"},attrs:{slot:"icon",type:"exclamation-circle"},slot:"icon"}),a("a",[t._v("删除")])],1)],1)]}}])})],1)],1),a("a-drawer",{staticClass:"huahua-drawer",attrs:{title:"添加学生",width:720,destroyOnClose:"",visible:t.visible},on:{close:t.onClose}},[a("a-form",{attrs:{form:t.form,layout:"vertical","hide-required-mark":""}},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"班级"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["ceaClassId",{rules:[{required:!0,message:"请选择学生班级"}]}],expression:"[\n                'ceaClassId',\n                {\n                  rules: [{ required: true, message: '请选择学生班级' }]\n                }\n              ]"}],attrs:{allowClear:"",placeholder:"请选择学生班级"}},t._l(t.classList,(function(e){return a("a-select-option",{key:e.ceaClassId,attrs:{value:e.ceaClassId}},[t._v(" "+t._s(e.ceaClassName)+" ")])})),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"姓名"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ceaStudentName",{rules:[{required:!0,message:"请输入学生姓名"}]}],expression:"[\n                'ceaStudentName',\n                {\n                  rules: [{ required: true, message: '请输入学生姓名' }]\n                }\n              ]"}],attrs:{allowClear:"",placeholder:"请输入学生姓名"}})],1)],1)],1),a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"性别"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["ceaStudentGender",{rules:[{required:!0,message:"请选择学生性别"}]}],expression:"[\n                'ceaStudentGender',\n                {\n                  rules: [{ required: true, message: '请选择学生性别' }]\n                }\n              ]"}],attrs:{allowClear:"",placeholder:"请选择学生性别"}},[a("a-select-option",{attrs:{value:0}},[t._v(" 男 ")]),a("a-select-option",{attrs:{value:1}},[t._v(" 女 ")])],1)],1)],1)],1)],1),a("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[a("a-button",{style:{marginRight:"8px"},on:{click:t.onClose}},[t._v(" 取消 ")]),a("a-button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:t.onAddStudent}},[t._v(" 提交 ")])],1)],1)],2)}),[],!1,null,null,null);e.default=w.exports},6359:function(t,e,a){var n=a("f67a");n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a("499e").default)("de60db52",n,!0,{sourceMap:!1,shadowMode:!1})},cd77:function(t,e,a){"use strict";a.d(e,"b",(function(){return s})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return c}));var n=a("53ca"),r=(a("d3b7"),a("ac1f"),a("1276"),a("b0c0"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("fb6a"),a("c19f"),a("3ca3"),a("ddb0"),a("2b3d"),a("1146")),o=a.n(r);function s(t){var e=this;return new Promise((function(a,n){if("xls"!==t.name.split(".")[1]&&"xlsx"!==t.name.split(".")[1])e.$message.error("上传文件格式错误，请上传xls、xlsx文件！");else{var r=new FileReader;r.onload=function(t){var e=function(t){for(var e="",a=0,n=10240;a<t.byteLength/n;++a)e+=String.fromCharCode.apply(null,new Uint8Array(t.slice(a*n,a*n+n)));return e+=String.fromCharCode.apply(null,new Uint8Array(t.slice(a*n)))}(t.target.result),n=o.a.read(btoa(e),{type:"base64"}),r=n.SheetNames[0],s=n.Sheets[r],i=o.a.utils.sheet_to_json(s);a(i)},r.readAsArrayBuffer(t)}}))}function i(t){for(var e=[],a=0;a<t.length;a++)e[a]=t[a].name||"sheet".concat(a+1);for(var n={SheetNames:e,Sheets:{}},r=0;r<t.length;r++)n.Sheets[t[r].name]=t[r].sheet;var s=o.a.write(n,{bookType:"xlsx",bookSST:!1,type:"binary"});return new Blob([function(t){for(var e=new ArrayBuffer(t.length),a=new Uint8Array(e),n=0;n!==t.length;++n)a[n]=255&t.charCodeAt(n);return e}(s)],{type:"application/octet-stream"})}function c(t,e){"object"===Object(n.a)(t)&&t instanceof Blob&&(t=URL.createObjectURL(t));var a,r=document.createElement("a");r.href=t,r.download=e||"",window.MouseEvent?a=new MouseEvent("click"):(a=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(a)}},d81d:function(t,e,a){"use strict";var n=a("23e7"),r=a("b727").map;n({target:"Array",proto:!0,forced:!a("1dde")("map")},{map:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},e4e2:function(t){t.exports=JSON.parse('[{"label":"班级","value":"className"},{"label":"姓名","value":"name"},{"label":"性别","value":"gender"}]')},e4e7:function(t,e,a){"use strict";a("6359")},f67a:function(t,e,a){(e=a("24fb")(!1)).push([t.i,".k-ant-page-header .ant-page-header-heading-extra[data-v-a8a8cc38]{float:unset}.k-table .ant-table-pagination[data-v-a8a8cc38]{float:left!important}.k-table .ant-table-thead>tr>th[data-v-a8a8cc38]{background-color:#fff!important}.huahua-drawer .ant-select-selection__clear[data-v-a8a8cc38]{margin-top:-8px}.single[data-v-a8a8cc38]{background-color:#fbfafa}.windows[data-v-a8a8cc38] ::-webkit-scrollbar{width:6px;height:6px}.windows[data-v-a8a8cc38] ::-webkit-scrollbar-track{width:10px;background:rgba(145,146,146,.1);border-radius:2em}.windows[data-v-a8a8cc38] ::-webkit-scrollbar-thumb{background-color:rgba(145,146,146,.3);background-clip:padding-box;min-height:28px;border-radius:2em}.windows[data-v-a8a8cc38] ::-webkit-scrollbar-corner{border-radius:2em}.windows[data-v-a8a8cc38] ::-webkit-scrollbar-thumb:hover{background-color:#919292}.input-button input[data-v-a8a8cc38]{position:absolute;font-size:100px;right:0;top:0;opacity:0;filter:alpha(opacity=0);cursor:pointer}",""]),t.exports=e}}]);